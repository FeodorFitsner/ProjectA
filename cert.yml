version: 1.21.{build}
environment:
  certStr:
    secure: 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
install:
- ps: $bytes = [System.Convert]::FromBase64String($env:certStr)
- ps: $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2
- ps: $cert.Import($bytes)
- ps: Install-Certificate -Certificate $cert -StoreLocation CurrentUser
- ps: Export-PfxCertificate -Cert $cert -FilePath $env:APPVEYOR_BUILD_FOLDER\myCert.pfx

build_script:
- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
